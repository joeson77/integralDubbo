<?xml version="1.0" encoding="GBK" ?>  
<!DOCTYPE mapper  
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
<mapper namespace="com.test.dao.UsersMapper">  
  
    <!-- 表字段显式 -->  
    <sql id="userModel1">  
        users.userName AS "userName",  
        users.passWord AS "passWord",  
    </sql>  
    
    <!-- 根据 userName 查询 -->  
    <select id="selectUser" parameterType="com.test.entity.Users" resultType="com.test.entity.Users">  
        SELECT  
        id, userName, userPwd,userTel,userIntegral,userState
        FROM  
        users 
        WHERE
         (userName = #{userName} and userPwd= #{userPwd}) or (userTel = #{userName} and userPwd= #{userPwd})
    </select>  
    
    <!--  插入登陆信息-->
    <insert id="insertIPForUser">
    INSERT INTO userIP 
    (userName, userIP, insertTime)
     VALUES ( #{0}, #{1}, #{2})
    </insert>
    
     <!--  返回登陆信息-->
    <select id="userIP" resultType="com.test.entity.UserIP">
    SELECT id,userName,userIP,insertTime,serverOne,serverTwo,userStatue,ex1,ex2,ex3
    FROM userIP 
    WHERE userName=#{0}
    </select>
    
     <!--  查找用户-->
    <select id="selectUserIntegral" resultType="com.test.entity.Users">
    	select id, userName, userPwd,userTel,userIntegral,userState 
    	from users where userName = #{userName}
    </select>
    
    <!-- 更新状态 -->
    <update id="updateUserOnlineStatue" parameterType="com.test.entity.UserIP" >
    	update userIP SET userIP = #{userIP},userStatue = #{userStatue} 
    	where userName = #{userName}
    </update>
</mapper> 